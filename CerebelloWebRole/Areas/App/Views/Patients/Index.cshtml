@model PatientsIndexViewModel
@{
    ViewBag.Title = "Patient records · Cerebello";

    ViewBag.Watermark = "Search by the patient name";

    var localNow = (DateTime)this.ViewBag.LocalNow;

    var grid = this.Html.CreateGrid(this.Model.LastRegisteredPatients);
    grid.AddLinkField(m => m.LastName, "Details", m => new { id = m.Id });
    grid.AddLinkField(m => m.FirstName, "Details", m => new { id = m.Id });
    grid.AddField(m => m.Gender);
    grid.AddField(m => m.DateOfBirth, header: "DOB");
    grid.AddField(m => m.RecordNumber);
    grid.AddEditField("Edit", "Patients", model => new { model.Id });
}
@section Title {
Prontuário
}
@section Styles {
    <link type="text/css" rel="Stylesheet" href="/content/styles/app/jquery.jqplot.min.css" />
}
@section SideBar {
    <ul>
        <li>
            <a href="@Url.Action("Create", "Patients")" class="icon-link icon-link-plus">New patient</a>
        </li>
        @if (this.CanAccessAction("ExportDoctorXml", "Report"))
        {
            <li><a href="@Url.Action("ExportDoctorXml", "Report")" target="_blank" class="icon-link icon-link-import">Export XML</a> </li>
        }
        @if (this.CanAccessAction("ExportPatientsPdf", "Report"))
        {
            <li><a href="@Url.Action("ExportPatientsPdf", "Report")" target="_blank" class="icon-link icon-link-import">Export records in PDF</a> </li>
        }
        @if (this.CanAccessAction("DownloadAllPatientsZipFile", "PatientFiles"))
        {
            <li><a href="@Url.Action("DownloadAllPatientsZipFile", "PatientFiles")" class="icon-link icon-link-import">Export all patients files in ZipCode</a> </li>
        }
    </ul>
}
@using (Html.BeginForm("search", null, FormMethod.Get))
{
    @Html.Partial("SearchBox", new SearchModel())
}
<div class="widget">
    <h2>Last registered patients
    </h2>
    @grid.GetHtml()
</div>
